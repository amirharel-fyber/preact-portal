{"version":3,"file":null,"sources":["../src/preact-portal.js"],"sourcesContent":["import { h, Component, render } from 'preact';\n\n/** Redirect rendering of descendants into the given CSS selector.\n *  @example\n *    <Portal into=\"body\">\n *      <div>I am rendered into document.body</div>\n *    </Portal>\n */\nexport default class Portal extends Component {\n\tcomponentDidUpdate(props) {\n\t\tfor (let i in props) {\n\t\t\tif (props[i]!==this.props[i]) {\n\t\t\t\treturn setTimeout(this.renderLayer);\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.isMounted=true;\n\t\tthis.renderLayer = this.renderLayer.bind(this);\n\t\tthis.renderLayer();\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.renderLayer(false);\n\t\tthis.isMounted=false;\n\t\tif (this.remote) this.remote.parentNode.removeChild(this.remote);\n\t}\n\n\tfindNode(node) {\n\t\treturn typeof node==='string' ? this.getDocument().querySelector(node) : node;\n\t}\n\t\n\tgetDocument() {\n\t\tif (this.props.getDocument) {\n\t\t\treturn this.props.getDocument();\n\t\t}\n\t\treturn document;\n\t}\n\n\trenderLayer(show=true) {\n\t\tif (!this.isMounted) return;\n\n\t\t// clean up old node if moving bases:\n\t\tif (this.props.into!==this.intoPointer) {\n\t\t\tthis.intoPointer = this.props.into;\n\t\t\tif (this.into && this.remote) {\n\t\t\t\tthis.remote = render(<PortalProxy />, this.into, this.remote);\n\t\t\t}\n\t\t\tthis.into = this.findNode(this.props.into);\n\t\t}\n\n\t\tthis.remote = render((\n\t\t\t<PortalProxy context={this.context}>\n\t\t\t\t{ show && this.props.children || null }\n\t\t\t</PortalProxy>\n\t\t), this.into, this.remote);\n\t}\n\n\trender() {\n\t\treturn null;\n\t}\n}\n\n\n// high-order component that renders its first child if it exists.\n// used as a conditional rendering proxy.\nclass PortalProxy extends Component {\n\tgetChildContext() {\n\t\treturn this.props.context;\n\t}\n\trender({ children }) {\n\t\treturn children && children[0] || null;\n\t}\n}\n"],"names":["Portal","componentDidUpdate","props","i","setTimeout","renderLayer","componentDidMount","isMounted","bind","componentWillUnmount","remote","parentNode","removeChild","findNode","node","getDocument","querySelector","document","show","into","intoPointer","render","h","context","children","Component","PortalProxy","getChildContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAQqBA;;;;;;;;kBACpBC,iDAAmBC,OAAO;OACpB,IAAIC,CAAT,IAAcD,KAAd,EAAqB;OAChBA,MAAMC,CAAN,MAAW,KAAKD,KAAL,CAAWC,CAAX,CAAf,EAA8B;WACtBC,WAAW,KAAKC,WAAhB,CAAP;;;;;kBAKHC,iDAAoB;OACdC,SAAL,GAAe,IAAf;OACKF,WAAL,GAAmB,KAAKA,WAAL,CAAiBG,IAAjB,CAAsB,IAAtB,CAAnB;OACKH,WAAL;;;kBAGDI,uDAAuB;OACjBJ,WAAL,CAAiB,KAAjB;OACKE,SAAL,GAAe,KAAf;MACI,KAAKG,MAAT,EAAiB,KAAKA,MAAL,CAAYC,UAAZ,CAAuBC,WAAvB,CAAmC,KAAKF,MAAxC;;;kBAGlBG,6BAASC,MAAM;SACP,OAAOA,IAAP,KAAc,QAAd,GAAyB,KAAKC,WAAL,GAAmBC,aAAnB,CAAiCF,IAAjC,CAAzB,GAAkEA,IAAzE;;;kBAGDC,qCAAc;MACT,KAAKb,KAAL,CAAWa,WAAf,EAA4B;UACpB,KAAKb,KAAL,CAAWa,WAAX,EAAP;;SAEME,QAAP;;;kBAGDZ,qCAAuB;MAAXa,IAAW,uEAAN,IAAM;;MAClB,CAAC,KAAKX,SAAV,EAAqB;;MAGjB,KAAKL,KAAL,CAAWiB,IAAX,KAAkB,KAAKC,WAA3B,EAAwC;QAClCA,WAAL,GAAmB,KAAKlB,KAAL,CAAWiB,IAA9B;OACI,KAAKA,IAAL,IAAa,KAAKT,MAAtB,EAA8B;SACxBA,MAAL,GAAcW,cAAOC,SAAC,WAAD,OAAP,EAAwB,KAAKH,IAA7B,EAAmC,KAAKT,MAAxC,CAAd;;QAEIS,IAAL,GAAY,KAAKN,QAAL,CAAc,KAAKX,KAAL,CAAWiB,IAAzB,CAAZ;;;OAGIT,MAAL,GAAcW,cACbC;cAAA;KAAa,SAAS,KAAKC,OAA3B;WACW,KAAKrB,KAAL,CAAWsB,QAAnB,IAA+B;GAFrB,EAIX,KAAKL,IAJM,EAIA,KAAKT,MAJL,CAAd;;;kBAODW,2BAAS;SACD,IAAP;;;;EApDkCI;;IA2D9BC;;;;;;;;uBACLC,6CAAkB;SACV,KAAKzB,KAAL,CAAWqB,OAAlB;;;uBAEDF,+BAAqB;MAAZG,QAAY,QAAZA,QAAY;;SACbA,YAAYA,SAAS,CAAT,CAAZ,IAA2B,IAAlC;;;;EALwBC;;;;"}
